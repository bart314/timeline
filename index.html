<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Renaissance timeline</title>

  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="d3-renaissance.js"></script>

  <style type="text/css">
    .axis path,
    .axis line {
      fill: none;
      stroke: black;
      shape-rendering: crispEdges;
    }

    .axis text {
      font-family: sans-serif;
      font-size: 10px;
    }

    .timeline-label {
      font-family: sans-serif;
      font-size: 12px;
    }

    #timeline2 .axis {
      transform: translate(0px,40px);
      -ms-transform: translate(0px,40px); /* IE 9 */
      -webkit-transform: translate(0px,40px); /* Safari and Chrome */
      -o-transform: translate(0px,40px); /* Opera */
      -moz-transform: translate(0px,40px); /* Firefox */
    }
    
    .coloredDiv {
      height:20px; width:20px; float:left;
    }

    body { font-family:Calibri,Helvetica,Verdana,sans-serif; }
    h3 { text-align:center; font-size:xx-large; }
    p { padding:0 10vw; line-height:140%;}
    p.small, footer { font-size:x-small; }
    rect, text { cursor:pointer; }
    a { text-decoration:none;}
    a:hover { text-decoration:underline;}


  </style>
</head>

<body>
    
<div id="main">
  <h3>Renaissance timeline</h3>
  <p class="small">
    <a href="#" onclick="toggle_intro(this);return false;">hide introduction</a> | 
    <a href="#" onclick="toggle_language(this);return false">English</a>
  </p>
 
  <div id="intro">
    <p>L'autunno scorso, ho letto <a href="https://www.amazon.com/Collector-Lives-Giorgio-Vasari-Invention/dp/0393241319" target="_blank">The Collector of Lives; Giorgio Vasari and the Invention of Art</a>, libro di <a href="https://history.nd.edu/people/ingrid-rowland/" target="_blank">Ingrid Rowland</a> e <a href="https://noahcharney.smugmug.com/" target="_blank">Noah Charney</a>. Quest'è un opero molto interessante sulla Rinascimento Italiano, descrivendo i eventi politiche che occorrevano e i artisti più importanti qui vivevano sull'epoca – e anche il ruolo giocato dalla famiglia dei Medici.</p>
    <p>Nonostante il libro contiene un pedigree della Medici, il manca un schema utile su queste persone e eventi. Leggendo, uno perde la panoramico su tutte le nome en influenze. Non è immediatamente chiaro chi vive nel stesso tempo con chi, chi è stato un gran influence su chi, o che eventi occorrano quando. Cioè, per rimediare queste perdita, ho fatto queste pagina. Il mostra i protagonisti più importanti sul libro, compreso links a le pagine relative su wikipedia.</p>
  </div>

   <div id="timeline"></div>

   <footer>
     Last update: 30 December 2021<br/>
     Check <a href="https://github.com/bart314/timeline">this repo on github</a>
   </footer>
</div>
</body>


<script>
  let text_backup = `
    <p>In the fall of 2021, I read <a href="https://www.amazon.com/Collector-Lives-Giorgio-Vasari-Invention/dp/0393241319" target="_blank">The Collector of Lifes:  Giorgio Vasari and the Invention of Art</a>. In many ways, a very interesting book, giving lots of information about the Italian Renaissance, the most important artists that emerged during this period, and the role the Medici-family played in these developments. Apart from this, the work includes the most important political events that colored the period</p>
    <p>Though the edition does include a pedigree of the Medici, it fails to deliver a clear and tranparent overview of all these persons and events. It is unclear which artists co-existed with which other artists or which members of the Medici. This page is an attempt to make up for this lack. It shows the lifelines of the most important protagonists, including links to the corresponding wikipedia-pages.</p>
  `
  function toggle_language(el){
    const d = document.querySelector("#intro")
    let tmp = d.innerHTML
    d.innerHTML = text_backup
    text_backup = tmp
    el.innerHTML =  el.innerHTML.toLowerCase()=='english' ? 'Italiano' : 'English'
  }
  
  function toggle_intro(el) {
    const d = document.querySelector("#intro")
    if (d.style.display == 'none') {
      d.style.display = 'block'
      el.innerHTML = 'hide introduction'
    } else {
      d.style.display ='none'
      el.innerHTML = 'show introduction'
    }
  }

  const width = document.querySelector('#main').offsetWidth
  function create_timeline(data) {
    var chart = d3.timeline()
    .tickFormat(
          {
          format:d3.time.format("%Y"),
          tickInterval: 1,
          tickSize: 30})
      .beginning(new Date(1300,1,1)) // we can optionally add beginning and ending times to speed up rendering a little
      .ending(new Date(1700,1,1))
      .showTimeAxisTick() // toggles tick marks
      .stack()
      .margin({left:70, right:30, top:0, bottom:0})
      .hlines([19])
    var svg = d3.select("#timeline").append("svg").attr("width", width)
      .datum(data).call(chart)
  }

function get_data_point(data) {
  return  {
        starting_time:new Date(data.van),
        ending_time:new Date(data.tot),
        label:data.naam,
        url: data.url
      }
}

function translate_data(json) {
  const cats = ['artists','medici']
  let rv = []
  cats.forEach( cat => {
    json[cat].forEach( el => {
      tmp_array = []
      if (el.length != undefined) {  // el is array of arrays
        el.forEach ( (data,id) => tmp_array.push(get_data_point(data)) )
      } else {
        tmp_array.push(get_data_point(el))
      }

      rv.push({'times':tmp_array})
    })
  })
  return rv 
}

fetch('data.json')
  .then( resp => resp.json() )
  .then (json => translate_data(json) )
  .then (data => create_timeline(data) )

</script>
</html>
