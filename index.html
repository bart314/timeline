<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Renaissance tijdlijn</title>

  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="d3-renaissance.js"></script>

  <style type="text/css">
    .axis path,
    .axis line {
      fill: none;
      stroke: black;
      shape-rendering: crispEdges;
    }

    .axis text {
      font-family: sans-serif;
      font-size: 10px;
    }

    .timeline-label {
      font-family: sans-serif;
      font-size: 12px;
    }

    #timeline2 .axis {
      transform: translate(0px,40px);
      -ms-transform: translate(0px,40px); /* IE 9 */
      -webkit-transform: translate(0px,40px); /* Safari and Chrome */
      -o-transform: translate(0px,40px); /* Opera */
      -moz-transform: translate(0px,40px); /* Firefox */
    }
    
    .coloredDiv {
      height:20px; width:20px; float:left;
    }

    body { font-family:Calibri,Helvetica,Verdana,sans-serif; }
    h3 { text-align:center; font-size:xx-large; }
    p { padding:0 10vw; line-height:140%;}
    p.small, footer { font-size:x-small; }
    rect, text { cursor:pointer; }
    a { text-decoration:none;}
    a:hover { text-decoration:underline;}


  </style>
</head>

<body>
    
<div id="main">
  <h3>Renaissance timeline</h3>
  <p class="small"><a href="#" onclick="toggle_intro(this);return false;">hide introduction</a></p>
 
  <div id="intro">
  <p>In the fall of 2021, I read <a href="https://www.amazon.com/Collector-Lives-Giorgio-Vasari-Invention/dp/0393241319" target="_blank">The Collector of Lifes:  Giorgio Vasari and the Invention of Art</a>. In many ways, a very interesting book, conting lot of information about the Italian Renaissance, the most important artists that emerged during this period, and the role the Medici-family played in these developments. Apart from this, the work includes the most important political events that colored the period</p>

  <p>Though the edition does include a pedigree of the Medici, it fails to deliver a clear and tranparent overview of all these persons and events. It is unclear which artists co-existed with which other artists or which members of the Medici. This page is an attempt to make up for this lack. It shows the lifelines of the most important protagonists, including links to the corresponding wikipedia-pages.</p>
  </div>
   <div id="timeline"></div>

   <footer>
     Last update: 30 December 2021<br/>
     Check <a href="https://github.com/bart314/timeline">this repo on github</a>
   </footer>
</div>
</body>


<script>
  function toggle_intro(el) {
    const d = document.querySelector("#intro")
    if (d.style.display == 'none') {
      d.style.display = 'block'
      el.innerHTML = 'hide introduction'
    } else {
      d.style.display ='none'
      el.innerHTML = 'show introduction'
    }
  }

  const width = document.querySelector('#main').offsetWidth
  function create_timeline(data) {
    var chart = d3.timeline()
    .tickFormat(
          {
          format:d3.time.format("%Y"),
          tickInterval: 1,
          tickSize: 30})
      .beginning(new Date(1300,1,1)) // we can optionally add beginning and ending times to speed up rendering a little
      .ending(new Date(1700,1,1))
      .showTimeAxisTick() // toggles tick marks
      .stack()
      .margin({left:70, right:30, top:0, bottom:0})
      .hlines([19])
    var svg = d3.select("#timeline").append("svg").attr("width", width)
      .datum(data).call(chart)
  }

function get_data_point(data) {
  return  {
        starting_time:new Date(data.van),
        ending_time:new Date(data.tot),
        label:data.naam,
        url: data.url
      }
}

function translate_data(json) {
  const cats = ['artists','medici']
  let rv = []
  cats.forEach( cat => {
    json[cat].forEach( el => {
      tmp_array = []
      if (el.length != undefined) {  // el is array of arrays
        el.forEach ( (data,id) => tmp_array.push(get_data_point(data)) )
      } else {
        tmp_array.push(get_data_point(el))
      }

      rv.push({'times':tmp_array})
    })
  })
  return rv 
}

fetch('data.json')
  .then( resp => resp.json() )
  .then (json => translate_data(json) )
  .then (data => create_timeline(data) )

</script>
</html>
